
<div class="big-container bg-image" style="position: relative;">
  <img src="/assets/naruto.png" alt="Description de l'image" class="naruto">

  <div class="inner-container1 bg-gray-100 shadow d-flex flex-column align-items-center">
    <!-- Contenu du premier conteneur -->
    <%= cl_image_tag('https://res.cloudinary.com/dtjuz4kkr/image/upload/v1686851125/animetrek_logo_fnexfu.png', class: 'logo-image') %>
    <img src="<%= current_user.photo %>" alt="User Photo" class="mt-5 mb-5 rounded-circle" width="120" height="120">
    <nav class="nav flex-column mt-2">
      <%= link_to "Home", root_path, class: "nav-link2 active mt-2 mb-3 rounded-pill border text-center", style: " border: 1px solid #8A5082; color: white; border-radius: 32px; padding: 5px; padding-left: 24px; padding-right: 24px; font-weight: 400; font-size: 16px; line-height: 24px; transition: 0.3s;" %>
      <%= link_to "Categories", search_path, class: "nav-link2 mb-3 mt-2 rounded-pill border text-center", style: "border: 1px solid #8A5082; color: white; border-radius: 32px; padding: 5px; padding-left: 24px; padding-right: 24px; font-weight: 400; font-size: 16px; line-height: 24px; transition: 0.3s;" %>
      <% if current_user.id == @user.id %>
      <%= link_to "Edit Profile", edit_user_registration_path, class: "nav-link2 mb-2 mt-2 rounded-pill border text-center", style:  "border: 1px solid #8A5082; color: white; border-radius: 32px; padding: 5px; padding-left: 24px; padding-right: 24px; font-weight: 400; font-size: 16px; line-height: 24px; transition: 0.3s;" %>
        <% else %>
      <%= link_to "My Profile", user_path(current_user), class: "nav-link2 mb-2 mt-2 rounded-pill border text-center", style:  "border: 1px solid #8A5082; color: white; border-radius: 32px; padding: 5px; padding-left: 24px; padding-right: 24px; font-weight: 400; font-size: 16px; line-height: 24px; transition: 0.3s;" %>
      <% end %>
    </nav>
    <%= image_tag('character.png', alt: 'Character Image', class: 'mt-auto', width: 200) %>
  </div>

  <div class="inner-container2 shadow ml-5">
    <!-- Contenu du deuxiÃ¨me conteneur -->
    <div class="cardfirst ml-5 mt-5">
      <div class="card-body text-center">
        <% if current_user.id == @user.id %>
          <h2>Hi, <%= @user.username %> ðŸ‘‹</h2>
          <p>Welcome to your Dashboard! Here you can view your watchlist and manage your anime collection.</p>
        <% else %>
          <h2>Welcome to <%= @user.username %>'s profile ðŸ‘‹ </h2>
        <% end %>
      </div>
    </div>
      <ul class="nav nav-tabs mx-2" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true" style="color: black;">Watchlist</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false" style="color: black;">Profile</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="edit-profile-tab" data-bs-toggle="tab" data-bs-target="#edit-profile" type="button" role="tab" aria-controls="edit-profile" aria-selected="false" style="color: black;">Edit Profile</button>
        </li>
      </ul>
    <div class="d-flex justify-content-start mx-2">
      <div class="cardsecond">
        <div class="card-body">
          <div class="container" style="height: 100vh;">
            <div class="inner-container">

              <div class="tab-content w-100" id="myTabContent">
                <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                  <div class="animes-container justify-content-start">
                    <div class="genre-section">
                      <h4 class="genre-title mt-5 mb-2">Watchlist - <%= pluralize @user.watchlists.count, "result" %></h4>
                    </div>
                    <div class="row row-cols-1 row-cols-md-5 gap-5" style="margin-left:10px">
                      <% @user.watchlists.each do |watchlist| %>
                        <div class="card-anime d-inline-block" style="width: 200px;">
                          <div class="image-card">
                            <%= image_tag watchlist.anime.image %>
                          </div>
                          <div class="info-anime">
                            <h2 style="font-size: 18px; width: 100%; overflow: hidden; text-overflow: ellipsis;"><%= watchlist.anime.title %></h2>
                            <small style="font-size: 12px;"> (<%= watchlist.anime.date_start.strftime("%d %b %Y") %>)</small>
                            <p style="font-size: 12px;overflow-x:hidden"><%= watchlist.anime.themes.join(", ") %></p>
                          </div>
                          <% if current_user == @user %>
                          <div class="card-icons">
                            <!--<ion-icon name="heart-outline"></ion-icon>-->
                            <%= button_to anime_watchlist_path(watchlist.anime, watchlist), method: :delete, data: { turbo_confirm: 'Are you sure?' }, class: 'custom-button-delete' do %>
                              <ion-icon name="trash-outline"></ion-icon>
                            <% end %>
                          </div>
                          <% end %>
                        </div>
                      <% end %>
                    </div>
                  </div>
                </div>
                <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                  <div class="d-flex flex-column align-items-center mt-5 mx-auto">
                    <img src="<%= @user.photo %>" alt="User Photo" class="mt-3 mb-5 rounded-circle" width="120" height="120">
                    <h2>Username: <%= @user.username %></h2>
                    <p>Email: <%= @user.email %></p>
                    <p>Points: <%= @user.points %></p>
                    <p>Bio: <%= @user.bio %></p>
                  </div>
                </div>
                <div class="tab-pane fade" id="edit-profile" role="tabpanel" aria-labelledby="edit-profile-tab">
                  <div class="d-flex flex-column align-items-center mt-5 mx-auto">
                    <div class="row">
                      <div class="col-md-6">
                        <div class="content-1">
                          <!-- Affichage de la photo -->
                          <div class="user-photo">
                            <% if current_user.photo %>
                              <%= image_tag(current_user.photo, alt: "User Photo") %>
                            <% else %>
                              <%= image_tag(asset_path("profile.png"), alt: "User Photo") %>
                            <% end %>
                          </div>

                          <!-- Champ de tÃ©lÃ©chargement de la photo -->
                          <%= simple_form_for(current_user, url: registration_path(current_user), method: :put) do |f| %>
                            <%= f.input :photo, as: :file %>
                            <%= f.button :submit, "Upload Photo", class: "UploadPhotoBtn" %>
                          <% end %>

                         <!-- <div class="confirmation">
                            <label for="confirm">Confirm:</label>
                            <input type="checkbox" id="confirm" name="confirm">
                          </div> -->
                        </div>
                      </div>

                      <div class="col-md-6">
                        <div class="content-2">
                          <h2>Edit Profile</h2>
                          <%= simple_form_for(current_user, url: registration_path(current_user), method: :put) do |f| %>
                            <%= f.input :username %>
                            <%= f.input :email %>
                            <%= f.input :bio, as: :text %>
                            <%= f.button :submit, "Update Profile", class: "buttontype1" %>
                            <%= button_tag "Cancel", type: :button, class: "buttontype2", onclick: "window.location.href='#{user_path(current_user)}'" %>
                          <% end %>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .big-container {
    display: flex;
    height: 100vh;
    justify-content: center;
    align-items: center;
    background-image: url('/assets/1318301.png');
    background-size: cover;
  }

  .container {
    display: flex;
    flex-direction: row;
  }

  .inner-container1 {
    flex: 0 0 15%;
    justify-content: flex-start; /* Espacement Ã  droite */
    margin-left: 70px;
    margin-top: 250px;
    margin-bottom: 100px;
    border-radius: 20px;
    height: 800px;
    background-color: rgba(255, 255, 255, 0.8);
  }

  .inner-container2 {
    flex: 1;
    width: 70%;
    margin-left: 70px;
    margin-top: 250px;
    margin-bottom: 100px;
    border-radius: 20px;
    margin-right: 70px;
    height: 800px;
    overflow-x: auto;
    white-space: nowrap;
    background-color: rgba(255, 255, 255, 0.8);
  }

  .logo-image {
    width: 200px;
    height: 47px;
    margin-top: 50px;
  }

  .custom-card-image {
    width: 50px;
    height: 50px;
  }

  .card-anime {
    margin-right: 1px;
    margin-bottom: 10px;
  }
  .card-icons {
    display: flex;
    align-items: center;
    margin-top: 10px;
    justify-content: flex-end;
    margin-bottom: 10px;
  }

  .card-icons ion-icon {
    font-size: 24px;
    color: black;
    margin-right: 5px;
  }
  .nav-link2 {
    background-color: black;
    border: 1px solid #8A5082;
    color: white;
    border-radius: 32px;
    padding: 5px;
    padding-left: 24px;
    padding-right: 24px;
    font-weight: 400;
    font-size: 16px;
    line-height: 24px;
    transition: 0.3s;
    text-decoration: none;
  }

  .nav-link2:hover {
    background-color: #8A5082;
    color: white;
  }
  .content-1 {
    margin-left: 50px;
    margin-right: 50px;
  }

  .content-2 {
    margin-left: 180px;
  }
  .UploadPhotoBtn {
    background-color: #8A5082;
    color: white;
    width: 150px;
    height: 40px;
    border-radius: 5px;
  }
  .buttontype1 {
    background-color: #8A5082;
    color: white;
    width: 150px;
    height: 40px;
    border-radius: 5px;
  }
  .buttontype2 {
    background-color: white;
    border: 2px solid #8A5082;
    color: #8A5082;
     width: 150px;
    height: 40px;
    border-radius: 5px;
  }
  .custom-button-delete{
    appearance: none;
    border: none;
    background-color: transparent;
  }
  .naruto {
  position: absolute;
  top: 1px;
  left: 1650px;
  height: 500px;

}

</style>
<script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
